<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0f172a" />
    <title>TapMood Web | WayV</title>
    <link rel="icon" href="assets/images/wayv-logo.svg" type="image/svg+xml" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="assets/css/app.css" />
    <style>
      /* Tiny polish without fighting your app.css */
      :root { color-scheme: light; }
      .no-scrollbar::-webkit-scrollbar{ display:none; }
      .no-scrollbar{ -ms-overflow-style:none; scrollbar-width:none; }
      .tap-focus:focus{ outline:none; box-shadow: 0 0 0 3px rgba(20,184,166,0.18); border-color: rgba(20,184,166,0.55); }
      .tm-card{ border-radius: 24px; border: 1px solid rgba(226,232,240,0.9); background: rgba(255,255,255,0.92); box-shadow: 0 18px 50px rgba(15,23,42,0.08); }
      .tm-pill{ border-radius: 999px; border: 1px solid rgba(226,232,240,1); background: white; }
      .tm-btn{ border-radius: 999px; font-weight: 700; letter-spacing: .18em; text-transform: uppercase; font-size: 11px; }
      .tm-btn-primary{ background:#0f172a; color:white; }
      .tm-btn-primary:hover{ background:#111c34; }
      .tm-btn-ghost{ background: rgba(241,245,249,1); color: rgba(51,65,85,1); }
      .tm-btn-ghost:hover{ background: rgba(226,232,240,1); }
      .tm-divider{ height: 1px; background: rgba(226,232,240,1); }
      .tm-skeleton{ background: linear-gradient(90deg, rgba(226,232,240,.6), rgba(226,232,240,1), rgba(226,232,240,.6)); background-size: 200% 100%; animation: tmsh 1.1s infinite linear; border-radius: 999px; }
      @keyframes tmsh { 0%{background-position:200% 0} 100%{background-position:-200% 0} }
      body { -webkit-tap-highlight-color: transparent; overscroll-behavior-y: none; }
      main { min-height: 100svh; }
    </style>
  </head>

  <body class="bg-[#F5F5F7] text-[#0b1220] font-sans antialiased selection:bg-teal-100 selection:text-teal-900">
    <main class="page-fade relative min-h-screen">
      <!-- Ambient blobs -->
      <div class="pointer-events-none fixed -top-24 right-10 hidden h-72 w-72 rounded-full bg-teal-200/30 blur-3xl md:block"></div>
      <div class="pointer-events-none fixed -bottom-24 left-10 hidden h-72 w-72 rounded-full bg-indigo-200/30 blur-3xl md:block"></div>

      <!-- ========================= -->
      <!-- Guest / Auth -->
      <!-- ========================= -->
      <section id="guest-view" class="relative flex min-h-screen items-center justify-center overflow-hidden px-6 py-16">
        <div class="w-full max-w-5xl rounded-[32px] border border-white/70 bg-white/80 p-8 shadow-[0_24px_80px_rgba(15,23,42,0.16)] backdrop-blur sm:p-10">
          <div class="grid gap-10 lg:grid-cols-[1.1fr_0.9fr]">
            <div class="space-y-6">
              <div class="inline-flex items-center gap-2 rounded-full bg-teal-50 px-4 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-teal-600">
                TapMood Web
                <span class="h-1.5 w-1.5 rounded-full bg-teal-400"></span>
              </div>

              <h1 class="text-4xl font-semibold tracking-tight text-slate-900 md:text-5xl">
                Your mood, your circle, everywhere.
              </h1>

              <p class="text-lg text-slate-600">
                A real social feed for how you feel. Post moods, react, message friends, and keep your profile synced across devices.
              </p>

              <div class="grid gap-3 sm:grid-cols-3">
                <div class="rounded-2xl border border-slate-100 bg-white/80 p-4 text-sm text-slate-600">üß† Mood feed</div>
                <div class="rounded-2xl border border-slate-100 bg-white/80 p-4 text-sm text-slate-600">üí¨ Real-time chat</div>
                <div class="rounded-2xl border border-slate-100 bg-white/80 p-4 text-sm text-slate-600">ü§ù Friends + requests</div>
              </div>

              <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4 text-sm text-slate-600">
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">What you can do</p>
                <ul class="mt-3 space-y-2">
                  <li>‚Ä¢ Post moods to your feed with emoji + label + intensity.</li>
                  <li>‚Ä¢ See friends‚Äô updates and keep your streak alive.</li>
                  <li>‚Ä¢ Message instantly with a clean inbox.</li>
                </ul>
              </div>
            </div>

            <!-- Keep your auth IDs intact -->
            <div id="auth-card" class="rounded-[28px] border border-slate-100 bg-white p-6 shadow-[0_18px_50px_rgba(15,23,42,0.12)]">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-xs font-semibold uppercase tracking-[0.3em] text-teal-500">Account Access</p>
                  <h2 class="mt-2 text-2xl font-semibold text-slate-900">Welcome back</h2>
                </div>
                <span id="connection-status" class="rounded-full bg-slate-100 px-3 py-1 text-[11px] font-semibold uppercase tracking-widest text-slate-500">Checking</span>
              </div>

              <div class="mt-5 flex gap-2">
                <button id="auth-signin" type="button" class="flex-1 rounded-full bg-slate-900 px-3 py-2 text-xs font-semibold uppercase tracking-widest text-white">Sign In</button>
                <button id="auth-signup" type="button" class="flex-1 rounded-full border border-slate-200 px-3 py-2 text-xs font-semibold uppercase tracking-widest text-slate-600">Sign Up</button>
              </div>

              <form id="auth-form" class="mt-6 space-y-4">
                <div id="auth-username-field" class="hidden">
                  <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Username</label>
                  <input id="auth-username" type="text" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="yourname" />
                </div>
                <div>
                  <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Email</label>
                  <input id="auth-email" type="email" required class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="you@tapmood.com" />
                </div>
                <div>
                  <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Password</label>
                  <input id="auth-password" type="password" required class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="At least 8 characters" />
                </div>
                <button id="auth-submit" type="submit" class="w-full rounded-full bg-[#0f172a] px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-slate-200/50 transition hover:bg-slate-900">Sign In</button>
                <p id="auth-helper" class="text-xs text-slate-400">Use the same TapMood credentials you already have on mobile.</p>
                <p id="auth-message" class="text-sm text-slate-600"></p>
              </form>

              <div class="mt-6 rounded-2xl border border-slate-100 bg-slate-50 p-4">
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Tip</p>
                <p class="mt-2 text-sm text-slate-600">After signing in, TapMood becomes a feed-first app. Post moods like stories, not like forms.</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ========================= -->
      <!-- App Shell -->
      <!-- ========================= -->
      <section id="app-view" class="hidden">
        <!-- Top bar -->
        <header class="sticky top-0 z-40 border-b border-slate-200 bg-white/85 backdrop-blur">
          <div class="mx-auto flex max-w-7xl items-center justify-between gap-3 px-4 py-3 sm:px-6">
            <div class="flex items-center gap-3">
              <img src="assets/images/wayv-logo.svg" alt="WayV" class="h-10 w-10 rounded-2xl bg-white p-2 shadow" />
              <div class="leading-tight">
                <p class="text-[10px] font-semibold uppercase tracking-[0.3em] text-teal-600">TapMood Web</p>
                <p class="text-base font-semibold text-slate-900">TapMood</p>
              </div>
            </div>

            <!-- Search -->
            <div class="hidden w-full max-w-lg lg:block">
              <div class="relative">
                <input
                  id="global-search"
                  type="text"
                  placeholder="Search people, moods, usernames‚Ä¶"
                  class="tap-focus w-full rounded-full border border-slate-200 bg-slate-50 px-12 py-2.5 text-sm text-slate-800"
                />
                <div class="pointer-events-none absolute left-4 top-1/2 -translate-y-1/2 text-slate-400">‚åï</div>
                <div id="global-search-hint" class="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-xs text-slate-400">Ctrl K</div>
              </div>
              <div id="global-search-results" class="mt-2 hidden rounded-3xl border border-slate-200 bg-white p-3 shadow-[0_20px_60px_rgba(15,23,42,0.18)]"></div>
            </div>

            <div class="flex items-center gap-2">
              <span id="connection-status-app" class="hidden rounded-full bg-emerald-100 px-3 py-1 text-[10px] font-semibold uppercase tracking-widest text-emerald-700 sm:inline-flex">Connected</span>

              <!-- Notifications -->
              <div class="relative">
                <button id="notifications-toggle" class="tm-pill flex items-center gap-2 px-4 py-2 text-xs font-semibold uppercase tracking-widest text-slate-700 transition hover:bg-slate-50">
                  Notifications
                  <span id="notifications-badge" class="hidden rounded-full bg-rose-500 px-2 py-0.5 text-[10px] font-semibold text-white">0</span>
                </button>

                <div id="notifications-panel" class="absolute right-0 mt-3 hidden w-[22rem] rounded-3xl border border-slate-200 bg-white p-4 text-left shadow-[0_20px_60px_rgba(15,23,42,0.2)]">
                  <div class="flex items-center justify-between">
                    <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Notifications</p>
                    <button id="notifications-close" class="rounded-full bg-slate-100 px-3 py-1 text-[10px] font-semibold uppercase tracking-widest text-slate-600 hover:bg-slate-200">Close</button>
                  </div>
                  <div id="notifications-list" class="mt-3 space-y-3 text-sm text-slate-600"></div>
                  <div class="mt-4 border-t border-slate-100 pt-4">
                    <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Friends</p>
                    <div id="notifications-friends" class="mt-3 space-y-2 text-sm text-slate-600"></div>
                  </div>
                </div>
              </div>

              <button id="sign-out" class="tm-btn tm-btn-ghost px-4 py-2">Sign Out</button>
            </div>
          </div>

          <!-- Mobile top nav (compact) -->
          <div class="mx-auto max-w-7xl px-4 pb-3 sm:px-6 lg:hidden">
            <div class="flex gap-2 overflow-x-auto no-scrollbar">
              <button data-page-target="home" class="tapmood-top-nav tm-pill px-4 py-2 text-xs font-semibold text-slate-700">Home</button>
              <button data-page-target="messages" class="tapmood-top-nav tm-pill px-4 py-2 text-xs font-semibold text-slate-700">Messages</button>
              <button data-page-target="friends" class="tapmood-top-nav tm-pill px-4 py-2 text-xs font-semibold text-slate-700">Friends</button>
              <button data-page-target="profile" class="tapmood-top-nav tm-pill px-4 py-2 text-xs font-semibold text-slate-700">Profile</button>
            </div>
          </div>
        </header>

        <!-- Desktop app layout -->
        <div class="mx-auto grid max-w-7xl grid-cols-1 gap-6 px-4 pb-28 pt-6 sm:px-6 lg:grid-cols-[260px_1fr_340px] lg:pb-16">
          <!-- Left sidebar (desktop) -->
          <aside class="hidden lg:block">
            <div class="tm-card p-4">
              <div class="flex items-center justify-between">
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Navigation</p>
                <span class="rounded-full bg-teal-50 px-3 py-1 text-[10px] font-semibold uppercase tracking-widest text-teal-700">Live</span>
              </div>

              <div class="mt-3 space-y-2">
                <button data-page-target="home" class="tapmood-top-nav w-full rounded-2xl px-4 py-3 text-left text-sm font-semibold text-slate-800 hover:bg-slate-50">
                  üè† Home
                  <p class="mt-1 text-xs font-normal text-slate-500">Feed + composer</p>
                </button>
                <button data-page-target="messages" class="tapmood-top-nav w-full rounded-2xl px-4 py-3 text-left text-sm font-semibold text-slate-800 hover:bg-slate-50">
                  üí¨ Messages
                  <p class="mt-1 text-xs font-normal text-slate-500">Inbox + chat</p>
                </button>
                <button data-page-target="friends" class="tapmood-top-nav w-full rounded-2xl px-4 py-3 text-left text-sm font-semibold text-slate-800 hover:bg-slate-50">
                  ü§ù Friends
                  <p class="mt-1 text-xs font-normal text-slate-500">Requests + discover</p>
                </button>
                <button data-page-target="profile" class="tapmood-top-nav w-full rounded-2xl px-4 py-3 text-left text-sm font-semibold text-slate-800 hover:bg-slate-50">
                  üë§ Profile
                  <p class="mt-1 text-xs font-normal text-slate-500">Bio + avatar</p>
                </button>
              </div>

              <div class="mt-4 tm-divider"></div>

              <div class="mt-4 rounded-2xl border border-slate-100 bg-slate-50 p-4">
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Shortcuts</p>
                <div class="mt-3 space-y-2 text-sm text-slate-600">
                  <p><span class="font-semibold">Ctrl K</span> search</p>
                  <p><span class="font-semibold">N</span> new mood</p>
                  <p><span class="font-semibold">M</span> messages</p>
                </div>
              </div>
            </div>
          </aside>

          <!-- Center content: pages -->
          <div class="space-y-6">
            <!-- ========================= -->
            <!-- HOME -->
            <!-- ========================= -->
            <section id="page-home" data-page="home" class="tapmood-page space-y-6">
              <!-- Composer -->
              <section class="tm-card p-6">
                <div class="flex flex-wrap items-center justify-between gap-4">
                  <div>
                    <p class="text-xs font-semibold uppercase tracking-[0.3em] text-teal-600">Post</p>
                    <h2 class="mt-2 text-xl font-semibold text-slate-900">Share your mood</h2>
                    <p class="text-sm text-slate-600">This appears in your friends‚Äô feed.</p>
                  </div>
                  <div class="flex flex-wrap gap-2">
                    <button id="open-mood-modal" class="tm-btn tm-btn-primary px-4 py-2">New Mood</button>
                    <button id="open-message-modal" class="tm-btn tm-btn-ghost px-4 py-2">New Message</button>
                  </div>
                </div>

                <!-- Keep your existing form IDs so current JS can still submit -->
                <form id="mood-form" class="mt-5 grid gap-3 sm:grid-cols-2">
                  <div>
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Emoji</label>
                    <input id="mood-emoji" type="text" maxlength="8" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="üòä" />
                  </div>
                  <div>
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Mood label</label>
                    <input id="mood-label" type="text" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="Happy, calm, focused‚Ä¶" />
                  </div>
                  <div>
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Intensity (1-5)</label>
                    <input id="mood-intensity" type="number" min="1" max="5" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="3" />
                  </div>
                  <div class="sm:col-span-2">
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Note</label>
                    <textarea id="mood-note" rows="3" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="What‚Äôs the vibe today?"></textarea>
                  </div>
                  <div class="sm:col-span-2 flex flex-wrap items-center justify-between gap-3">
                    <p id="mood-status" class="text-sm text-slate-600"></p>
                    <button type="submit" class="tm-btn tm-btn-primary px-5 py-2.5">Post</button>
                  </div>
                </form>
              </section>

              <!-- Feed -->
              <section class="tm-card p-6">
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <div>
                    <h3 class="text-lg font-semibold text-slate-900">Feed</h3>
                    <p class="text-sm text-slate-600">Latest moods from your circle.</p>
                  </div>
                  <div class="flex items-center gap-2">
                    <button id="refresh-dashboard" class="tm-btn tm-btn-ghost px-4 py-2">Refresh</button>
                    <button id="feed-filter" class="tm-btn tm-btn-ghost px-4 py-2">Filter</button>
                  </div>
                </div>

                <!-- Your existing container IDs (keep) -->
                <div id="activity-feed" class="mt-4 space-y-3 text-sm text-slate-700">
                  <!-- Good-looking default skeleton -->
                  <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                    <div class="flex items-center gap-3">
                      <div class="h-10 w-10 rounded-full bg-slate-200"></div>
                      <div class="flex-1">
                        <div class="tm-skeleton h-3 w-40"></div>
                        <div class="mt-2 tm-skeleton h-3 w-64"></div>
                      </div>
                    </div>
                    <div class="mt-4 tm-skeleton h-3 w-full"></div>
                    <div class="mt-2 tm-skeleton h-3 w-5/6"></div>
                  </div>
                </div>

                <!-- Keep your old list too if your JS fills it -->
                <div id="emotions-list" class="mt-6 hidden grid gap-4 md:grid-cols-3 text-sm text-slate-600"></div>
              </section>
            </section>

            <!-- ========================= -->
            <!-- MESSAGES -->
            <!-- ========================= -->
            <section id="page-messages" data-page="messages" class="tapmood-page hidden space-y-6">
              <div class="tm-card p-6">
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <div>
                    <h2 class="text-xl font-semibold text-slate-900">Messages</h2>
                    <p class="text-sm text-slate-600">Your social inbox with realtime presence and rich threads.</p>
                  </div>
                  <div class="flex flex-wrap items-center gap-2">
                    <button id="open-message-modal-2" class="tm-btn tm-btn-primary px-4 py-2">New message</button>
                    <button class="tm-btn tm-btn-ghost px-4 py-2">Create group</button>
                  </div>
                </div>
              </div>

              <div class="grid min-h-[calc(100svh-14rem)] gap-6 lg:grid-cols-[0.38fr_0.62fr]">
                <!-- Inbox -->
                <section class="tm-card flex h-full min-h-0 flex-col space-y-4 p-6">
                  <div class="flex items-center justify-between gap-2">
                    <div>
                      <h3 class="text-lg font-semibold text-slate-900">Chats</h3>
                      <p class="text-sm text-slate-600">Friends and active threads.</p>
                    </div>
                    <input id="inbox-search" type="text" placeholder="Search‚Ä¶" class="tap-focus w-40 rounded-full border border-slate-200 bg-slate-50 px-4 py-2 text-sm" />
                  </div>

                  <div class="rounded-2xl border border-slate-100 bg-slate-50/80 p-4">
                    <div class="flex items-center justify-between gap-2">
                      <p class="text-xs font-semibold uppercase tracking-widest text-slate-400">Friends</p>
                      <button data-page-target="friends" class="tapmood-top-nav text-[11px] font-semibold text-indigo-600 hover:text-indigo-500">View all</button>
                    </div>
                    <div id="messages-friends" class="mt-3 grid gap-2 text-sm text-slate-700">
                      <div class="rounded-2xl border border-slate-100 bg-white p-3">
                        <div class="tm-skeleton h-3 w-32"></div>
                        <div class="mt-2 tm-skeleton h-3 w-44"></div>
                      </div>
                    </div>
                  </div>

                  <div>
                    <div class="flex items-center justify-between">
                      <p class="text-xs font-semibold uppercase tracking-widest text-slate-400">Recents</p>
                      <span class="text-[11px] text-slate-400">Realtime</span>
                    </div>
                    <div id="messages-inbox" class="mt-3 flex-1 space-y-3 overflow-y-auto text-sm text-slate-700">
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <div class="tm-skeleton h-3 w-32"></div>
                        <div class="mt-2 tm-skeleton h-3 w-52"></div>
                      </div>
                      <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                        <div class="tm-skeleton h-3 w-28"></div>
                        <div class="mt-2 tm-skeleton h-3 w-44"></div>
                      </div>
                    </div>
                  </div>
                </section>

                <!-- Composer + thread -->
                <section class="tm-card flex h-full min-h-[70svh] flex-col overflow-hidden p-0">
                  <div class="flex flex-wrap items-center justify-between gap-4 border-b border-slate-100 bg-white px-6 py-5">
                    <div class="flex items-center gap-3">
                      <div id="message-thread-avatar" class="flex h-12 w-12 items-center justify-center rounded-2xl bg-slate-100 text-sm font-semibold text-slate-500">TM</div>
                      <div>
                        <h3 id="message-thread-name" class="text-lg font-semibold text-slate-900">Select a conversation</h3>
                        <p id="message-thread-status" class="text-sm text-slate-500">Tap a friend to open chat.</p>
                        <p id="message-typing-status" class="text-xs text-indigo-500"></p>
                      </div>
                    </div>
                    <div class="flex items-center gap-2 text-xs font-semibold text-slate-400">
                      <span class="rounded-full bg-slate-100 px-3 py-1">Secure</span>
                      <span class="rounded-full bg-slate-100 px-3 py-1">Realtime</span>
                    </div>
                  </div>

                  <div id="messages-list" class="flex-1 space-y-4 overflow-y-auto bg-slate-50/60 px-6 py-5 text-sm text-slate-700">
                    <p class="text-slate-500">Select a thread to see messages here.</p>
                  </div>

                  <div class="border-t border-slate-100 bg-white px-6 py-5">
                    <form id="message-form" class="grid gap-3">
                      <div class="flex flex-wrap items-center gap-3">
                        <span class="text-xs font-semibold uppercase tracking-widest text-slate-400">To</span>
                        <input id="message-recipient" type="text" class="tap-focus w-48 rounded-full border border-slate-200 bg-slate-50 px-4 py-2 text-sm" placeholder="@friendname" />
                        <span id="message-status" class="text-xs text-slate-500"></span>
                      </div>
                      <div class="flex flex-wrap items-end gap-3">
                        <textarea id="message-text" rows="2" class="tap-focus flex-1 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="Type your message..."></textarea>
                        <div class="flex items-center gap-2">
                          <button type="button" class="tm-btn tm-btn-ghost px-4 py-2">Attach</button>
                          <button type="submit" class="tm-btn tm-btn-primary px-5 py-2.5">Send</button>
                        </div>
                      </div>
                    </form>
                  </div>
                </section>
              </div>
            </section>

            <!-- ========================= -->
            <!-- FRIENDS -->
            <!-- ========================= -->
            <section id="page-friends" data-page="friends" class="tapmood-page hidden space-y-6">
              <div class="tm-card p-6">
                <div class="flex flex-wrap items-center justify-between gap-3">
                  <div>
                    <h2 class="text-xl font-semibold text-slate-900">Friends</h2>
                    <p class="text-sm text-slate-600">Search, requests, and discover people.</p>
                  </div>
                  <button id="friends-refresh" class="tm-btn tm-btn-ghost px-4 py-2">Refresh</button>
                </div>
              </div>

              <div class="grid gap-6 lg:grid-cols-[0.55fr_0.45fr]">
                <section class="tm-card p-6">
                  <h3 class="text-lg font-semibold text-slate-900">Add new friend</h3>
                  <p class="text-sm text-slate-600">Search by username or name.</p>
                  <div class="mt-4 space-y-4">
                    <input id="friend-search" type="text" class="tap-focus w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="Search by username or name" />
                    <div id="friend-search-results" class="grid gap-3 text-sm text-slate-700"></div>
                  </div>
                  <p id="friend-status" class="mt-4 text-sm text-slate-600"></p>

                  <div class="mt-6 tm-divider"></div>

                  <h4 class="mt-6 text-sm font-semibold text-slate-900">Your friends</h4>
                  <ul id="friends-list" class="mt-3 space-y-3 text-sm text-slate-700">
                    <li class="text-slate-500">Loading friends‚Ä¶</li>
                  </ul>
                </section>

                <div class="space-y-6">
                  <section class="tm-card p-6">
                    <h3 class="text-lg font-semibold text-slate-900">Friend requests</h3>
                    <p class="text-sm text-slate-600">Respond quickly.</p>
                    <div id="friend-requests" class="mt-4 space-y-3 text-sm text-slate-700">
                      <p class="text-slate-500">No requests yet.</p>
                    </div>
                  </section>

                  <section class="tm-card p-6">
                    <h3 class="text-lg font-semibold text-slate-900">Discover people</h3>
                    <p class="text-sm text-slate-600">Suggestions based on activity.</p>
                    <div id="friend-discover" class="mt-4 grid gap-3 sm:grid-cols-2 text-sm text-slate-700"></div>
                  </section>
                </div>
              </div>
            </section>

            <!-- ========================= -->
            <!-- PROFILE -->
            <!-- ========================= -->
            <section id="page-profile" data-page="profile" class="tapmood-page hidden space-y-6">
              <section class="tm-card p-6">
                <div class="flex flex-wrap items-start justify-between gap-4">
                  <div>
                    <h2 class="text-xl font-semibold text-slate-900">Your profile</h2>
                    <p class="text-sm text-slate-600">Public info, avatar, and bio.</p>
                  </div>
                  <button id="profile-refresh" class="tm-btn tm-btn-ghost px-4 py-2">Reload</button>
                </div>

                <div id="profile-card" class="mt-5 flex items-center gap-4 rounded-2xl border border-slate-100 bg-slate-50 p-4 text-sm text-slate-700">
                  <div class="h-12 w-12 rounded-full bg-slate-200"></div>
                  <div>
                    <p class="font-semibold">Not signed in</p>
                    <p class="text-slate-600">Sign in to load your profile.</p>
                  </div>
                </div>

                <form id="profile-form" class="mt-6 grid gap-3 sm:grid-cols-2">
                  <div>
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Display name</label>
                    <input id="profile-display-name" type="text" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" />
                  </div>
                  <div>
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Username</label>
                    <input id="profile-username" type="text" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" />
                  </div>
                  <div class="sm:col-span-2">
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Avatar URL</label>
                    <input id="profile-avatar" type="url" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm" placeholder="https://‚Ä¶" />
                  </div>
                  <div class="sm:col-span-2">
                    <label class="text-xs font-semibold uppercase tracking-widest text-slate-400">Bio</label>
                    <textarea id="profile-bio" rows="3" class="tap-focus mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm"></textarea>
                  </div>
                  <div class="sm:col-span-2 flex flex-wrap items-center justify-between gap-3">
                    <p id="profile-status" class="text-sm text-slate-600"></p>
                    <button type="submit" class="tm-btn tm-btn-primary px-5 py-2.5">Save</button>
                  </div>
                </form>
              </section>
            </section>
          </div>

          <!-- Right rail (desktop widgets) -->
          <aside class="hidden lg:block space-y-6">
            <!-- Snapshot (keeps your existing IDs) -->
            <section class="tm-card p-6">
              <div class="flex items-center justify-between gap-3">
                <div>
                  <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Snapshot</p>
                  <p class="mt-2 text-lg font-semibold text-slate-900">Your stats</p>
                </div>
                <button class="tm-btn tm-btn-ghost px-4 py-2" id="refresh-dashboard-2">Refresh</button>
              </div>

              <div class="mt-4 grid gap-3">
                <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                  <p class="text-xs font-semibold uppercase tracking-widest text-slate-400">Friends</p>
                  <p id="friends-count" class="mt-2 text-3xl font-semibold text-slate-900">0</p>
                </div>
                <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                  <p class="text-xs font-semibold uppercase tracking-widest text-slate-400">Messages</p>
                  <p id="messages-count" class="mt-2 text-3xl font-semibold text-slate-900">0</p>
                </div>
                <div class="rounded-2xl border border-slate-100 bg-slate-50 p-4">
                  <p class="text-xs font-semibold uppercase tracking-widest text-slate-400">Moods</p>
                  <p id="emotions-count" class="mt-2 text-3xl font-semibold text-slate-900">0</p>
                </div>
              </div>
            </section>

            <!-- Quick actions -->
            <section class="tm-card p-6">
              <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">Quick actions</p>
              <div class="mt-4 grid gap-2">
                <button data-page-target="home" class="tapmood-top-nav tm-btn tm-btn-primary px-5 py-2.5 text-left">Post a mood</button>
                <button data-page-target="messages" class="tapmood-top-nav tm-btn tm-btn-ghost px-5 py-2.5 text-left">Open inbox</button>
                <button data-page-target="friends" class="tapmood-top-nav tm-btn tm-btn-ghost px-5 py-2.5 text-left">Find friends</button>
              </div>
              <p class="mt-4 text-sm text-slate-600">
                Your JS can wire these to open modals or navigate pages.
              </p>
            </section>
          </aside>
        </div>

        <!-- Mobile bottom nav -->
        <nav class="fixed bottom-0 left-0 right-0 z-50 border-t border-slate-200 bg-white/90 backdrop-blur lg:hidden">
          <div class="mx-auto flex max-w-7xl items-center justify-around px-4 py-2">
            <button data-page-target="home" class="tapmood-top-nav flex flex-col items-center gap-1 rounded-2xl px-3 py-2 text-xs font-semibold text-slate-700">
              <span class="text-lg">üè†</span> Home
            </button>
            <button data-page-target="messages" class="tapmood-top-nav flex flex-col items-center gap-1 rounded-2xl px-3 py-2 text-xs font-semibold text-slate-700">
              <span class="text-lg">üí¨</span> Messages
            </button>
            <button id="mobile-new-mood" class="flex flex-col items-center gap-1 rounded-2xl bg-slate-900 px-4 py-2 text-xs font-semibold text-white">
              <span class="text-lg">Ôºã</span> New
            </button>
            <button data-page-target="friends" class="tapmood-top-nav flex flex-col items-center gap-1 rounded-2xl px-3 py-2 text-xs font-semibold text-slate-700">
              <span class="text-lg">ü§ù</span> Friends
            </button>
            <button data-page-target="profile" class="tapmood-top-nav flex flex-col items-center gap-1 rounded-2xl px-3 py-2 text-xs font-semibold text-slate-700">
              <span class="text-lg">üë§</span> Profile
            </button>
          </div>
        </nav>

        <!-- Toasts -->
        <div id="toast-host" class="pointer-events-none fixed right-4 top-20 z-[60] flex w-[22rem] max-w-[calc(100vw-2rem)] flex-col gap-2"></div>

        <!-- Database timeout popup -->
        <div id="db-timeout-popup" class="fixed inset-0 z-[80] hidden">
          <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm"></div>
          <div class="relative mx-auto mt-24 w-[92%] max-w-md">
            <div class="tm-card p-6">
              <div class="flex items-start justify-between gap-4">
                <div>
                  <p class="text-xs font-semibold uppercase tracking-[0.3em] text-rose-500">Connection issue</p>
                  <p class="mt-2 text-lg font-semibold text-slate-900">We‚Äôre having trouble loading TapMood right now.</p>
                  <p class="mt-3 text-sm text-slate-600">
                    It looks like the database is taking longer than usual. We‚Äôre sorry for the inconvenience and we‚Äôre already working to get things back to normal.
                  </p>
                </div>
                <button id="db-timeout-close" class="tm-btn tm-btn-ghost px-3 py-1.5">Close</button>
              </div>
              <div class="mt-4 flex flex-wrap gap-2">
                <button id="db-timeout-retry" class="tm-btn tm-btn-primary px-4 py-2">Try again</button>
                <button data-page-target="home" class="tapmood-top-nav tm-btn tm-btn-ghost px-4 py-2">Go home</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Mood modal (optional UI, safe even if unused) -->
        <div id="mood-modal" class="fixed inset-0 z-[70] hidden">
          <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm"></div>
          <div class="relative mx-auto mt-24 w-[92%] max-w-xl">
            <div class="tm-card p-6">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-xs font-semibold uppercase tracking-[0.3em] text-teal-600">New mood</p>
                  <p class="mt-2 text-lg font-semibold text-slate-900">Post to your feed</p>
                </div>
                <button id="mood-modal-close" class="tm-btn tm-btn-ghost px-4 py-2">Close</button>
              </div>
              <p class="mt-4 text-sm text-slate-600">
                This modal is wired by JS. You can reuse the existing #mood-form fields or clone them here later.
              </p>
            </div>
          </div>
        </div>

        <!-- Message modal (optional UI, safe even if unused) -->
        <div id="message-modal" class="fixed inset-0 z-[70] hidden">
          <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm"></div>
          <div class="relative mx-auto mt-24 w-[92%] max-w-xl">
            <div class="tm-card p-6">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-xs font-semibold uppercase tracking-[0.3em] text-indigo-600">New message</p>
                  <p class="mt-2 text-lg font-semibold text-slate-900">Send a DM</p>
                </div>
                <button id="message-modal-close" class="tm-btn tm-btn-ghost px-4 py-2">Close</button>
              </div>
              <p class="mt-4 text-sm text-slate-600">
                JS can focus #message-recipient, then #message-text.
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
      window.tapmoodConfig = {
        supabaseUrl: 'https://lxylwexfjhtzvepwvjal.supabase.co',
        supabaseAnonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx4eWx3ZXhmamh0enZlcHd2amFsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcwNTY3ODEsImV4cCI6MjA4MjYzMjc4MX0.78Jc7gu59eU5XOgZiVpkn4dq1GrX3uKCEsV_ffXCU3E'
      };
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="assets/js/includes.js"></script>
    <script src="assets/js/page-animations.js" defer></script>
    <script src="assets/js/navigation.js" defer></script>
    <script src="assets/js/tapmood-web.js" defer></script>

    <!-- Optional: tiny UX script that will not break your main logic -->
    <script>
      (function () {
        const qs = (s) => document.querySelector(s);

        // Keyboard shortcut hints
        window.addEventListener('keydown', (e) => {
          if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'k') {
            e.preventDefault();
            const el = qs('#global-search');
            if (el) el.focus();
          }
          if (!e.ctrlKey && !e.metaKey && e.key.toLowerCase() === 'n') {
            const btn = qs('#open-mood-modal');
            if (btn) btn.click();
          }
          if (!e.ctrlKey && !e.metaKey && e.key.toLowerCase() === 'm') {
            const btn = document.querySelector('[data-page-target="messages"]');
            if (btn) btn.click();
          }
        });

        // Modal toggles (safe even if you later remove these)
        const moodOpeners = ['#open-mood-modal', '#mobile-new-mood'].map(qs).filter(Boolean);
        const msgOpeners = ['#open-message-modal', '#open-message-modal-2'].map(qs).filter(Boolean);

        const moodModal = qs('#mood-modal');
        const msgModal = qs('#message-modal');
        const moodClose = qs('#mood-modal-close');
        const msgClose = qs('#message-modal-close');

        moodOpeners.forEach((b) => b.addEventListener('click', () => moodModal && moodModal.classList.remove('hidden')));
        msgOpeners.forEach((b) => b.addEventListener('click', () => msgModal && msgModal.classList.remove('hidden')));
        if (moodClose) moodClose.addEventListener('click', () => moodModal && moodModal.classList.add('hidden'));
        if (msgClose) msgClose.addEventListener('click', () => msgModal && msgModal.classList.add('hidden'));

        // Notifications close button
        const notifClose = qs('#notifications-close');
        const notifPanel = qs('#notifications-panel');
        if (notifClose && notifPanel) notifClose.addEventListener('click', () => notifPanel.classList.add('hidden'));

        // Duplicate refresh button maps to your existing handler if you wired it
        const r1 = qs('#refresh-dashboard');
        const r2 = qs('#refresh-dashboard-2');
        if (r1 && r2) r2.addEventListener('click', () => r1.click());
      })();
    </script>
  </body>
</html>
